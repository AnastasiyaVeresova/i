<!-- <!DOCTYPE HTML>
<html>
<head>
    <meta charset="utf-8" />
    <title>Convert Excel to HTML Table using JavaScript</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
        integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <script type="text/javascript" src="https://unpkg.com/xlsx@0.15.1/dist/xlsx.full.min.js"></script>
</head>
<body>
    <div class="container">
        <h2 class="text-center mt-4 mb-4"></h2>
        <div class="card">
            <div class="card-header"><b>Select Excel File</b></div>
            <div class="card-body">
                <input type="file" id="excel_file" />
            </div>
        </div>
        <div id="excel_data" class="mt-5"></div>
        <select id="sheet_list"></select>
        <div id="sheet_data"></div>
    </div>
</body>
</html>
<script>
    const excel_file = document.getElementById('excel_file');
    excel_file.addEventListener('change', (event) => {
        if (!['application/vnd.openxmlformats-officedocument.spreadsheetml.sheet', 'application/vnd.ms-excel'].includes(event.target.files[0].type)) {
            document.getElementById('excel_data').innerHTML = '<div class="alert alert-danger">Only .xlsx or .xls file format are allowed</div>';
            excel_file.value = '';
            return false;
        }
        var reader = new FileReader();
        reader.readAsArrayBuffer(event.target.files[0]);
        reader.onload = function (event) {
            var data = new Uint8Array(reader.result);
            var work_book = XLSX.read(data, { type: 'array' });
            var sheet_name = work_book.SheetNames;
            var sheet_data = XLSX.utils.sheet_to_json(work_book.Sheets[sheet_name[0]], { header: 1 });
            var sheet_list = document.getElementById('sheet_list');

            sheet_name.forEach(function (sheet) {
                var option = document.createElement('option');
                option.value = sheet;
                option.text = sheet;
                sheet_list.appendChild(option);
            });

            sheet_list.addEventListener('change', function () {
                var selected_sheet_name = sheet_list.value; // получаем имя выбранного листа
                var selected_sheet_data = xlsx.utils.sheet_to_json(work_book.sheets[selected_sheet_name], { header: 1 }); // получаем данные выбранного листа
                // Отображаем данные выбранного листа на странице
                var table = "<table>";
                selected_sheet_data.forEach(function (row) {
                    table += "<tr>";
                    row.forEach(function (cell) {
                        table += "<td>" + cell + "</td>";
                    });
                    table += "</tr>";
                });
                table += "</table>";
                document.getElementById('sheet_data').innerHTML = table; // отображаем таблицу данных на странице
            });
            if (sheet_data.length > 0) {
                var table_output = '<table class="table table-striped table-bordered">';
                for (var row = 0; row < sheet_data.length; row++) {
                    table_output += '<tr>';
                    for (var cell = 0; cell < sheet_data[row].length; cell++) {
                        if (row == 0) {
                            table_output += '<th>' + sheet_data[row][cell] + '</th>';
                        }
                        else {
                            table_output += '<td>' + sheet_data[row][cell] + '</td>';
                        }
                    }
                    table_output += '</tr>';
                }
                table_output += '</table>';
                document.getElementById('excel_data').innerHTML = table_output;
            }
            excel_file.value = '';
        }
    });
</script> -->

<!DOCTYPE HTML>
<html>
<head>
    <meta charset="utf-8" />
    <title>Display Excel Sheets in Dropdown List</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.9/xlsx.full.min.js"></script>
</head>
<body>
    <div class="container">
        <h2>Select Excel Sheet:</h2>
        <input type="file" id="excel_file_input">
        <select id="sheet_list"></select>
        <div id="sheet_data"></div>
    </div>
</body>
<script>
    var sheet_list = document.getElementById('sheet_list');
    var sheet_data_div = document.getElementById('sheet_data');
    var workbook = null;

    var excel_file_input = document.getElementById('excel_file_input');
    excel_file_input.addEventListener('change', function(e) {
        var file = e.target.files[0];
        var reader = new FileReader();
        reader.onload = function(e) {
            var data = new Uint8Array(e.target.result);
            workbook = XLSX.read(data, {type: 'array'});
            var sheetNames = workbook.SheetNames;

            sheet_list.innerHTML = ''; // Clear existing options

            sheetNames.forEach(function(sheetName) {
                var option = document.createElement('option');
                option.value = sheetName;
                option.text = sheetName;
                sheet_list.appendChild(option);
            });
        };

        reader.readAsArrayBuffer(file);
    });

    sheet_list.addEventListener('change', function() {
        var selectedSheetName = sheet_list.value;
        var sheetData = XLSX.utils.sheet_to_html(workbook.Sheets[selectedSheetName]);
        sheet_data_div.innerHTML = sheetData;
    });
</script>
</html>
